# 二次元社区开发规范文档

## 1. 项目架构

### 1.1 前端架构 (Vue 3)
```
src/
├── assets/          # 静态资源
├── components/      # 公共组件
├── views/          # 页面组件
├── router/         # 路由配置
├── store/          # Vuex状态管理
├── api/            # API接口封装
├── utils/          # 工具函数
└── styles/         # 全局样式
```

### 1.2 后端架构 (Django)
```
backend/
├── apps/           # Django应用
├── config/         # 配置文件
├── utils/          # 工具函数
├── middleware/     # 中间件
└── templates/      # 模板文件
```

## 2. 命名规范

### 2.1 前端命名规范

#### 文件命名
- 组件文件使用大驼峰: `UserProfile.vue`
- 工具类文件使用小驼峰: `httpRequest.js`
- 样式文件使用kebab-case: `main-style.scss`

#### 变量命名
```javascript
// 常量使用大写下划线
const MAX_COUNT = 10

// 变量使用小驼峰
let userName = 'anime'

// 组件名使用大驼峰
export default {
  name: 'UserProfile'
}
```

### 2.2 后端命名规范

#### Python文件命名
- 模块文件使用小写下划线: `user_service.py`
- 类名使用大驼峰: `class UserProfile`
- 函数名使用小写下划线: `def get_user_info()`

## 3. 编码规范

### 3.1 Vue组件规范

```vue
<template>
  <!-- template内容保持简洁 -->
  <div class="component-name">
    <h1>{{ title }}</h1>
  </div>
</template>

<script>
export default {
  name: 'ComponentName',
  
  // props定义要详细
  props: {
    title: {
      type: String,
      required: true
    }
  },
  
  // data必须是函数
  data() {
    return {
      message: ''
    }
  },
  
  // 生命周期钩子按顺序排列
  created() {
    this.init()
  },
  
  // 方法按功能分组
  methods: {
    init() {
      // 初始化逻辑
    }
  }
}
</script>

<style lang="scss" scoped>
// 使用scoped避免样式污染
.component-name {
  // 样式嵌套不超过3层
}
</style>
```

### 3.2 Django规范

```python
# models.py
from django.db import models

class User(models.Model):
    """用户模型类"""
    username = models.CharField(max_length=100)
    created_at = models.DateTimeField(auto_now_add=True)
    
    class Meta:
        db_table = 'user'
        ordering = ['-created_at']

    def __str__(self):
        return self.username

# views.py
from rest_framework.viewsets import ModelViewSet

class UserViewSet(ModelViewSet):
    """用户视图集"""
    queryset = User.objects.all()
    serializer_class = UserSerializer
```

## 4. API规范

### 4.1 接口命名
- 使用RESTful风格
- URL使用小写字母
- 用中划线分隔单词

```
GET    /api/users              # 获取用户列表
POST   /api/users             # 创建用户
GET    /api/users/{id}        # 获取单个用户
PUT    /api/users/{id}        # 更新用户
DELETE /api/users/{id}        # 删除用户
```

### 4.2 响应格式
```json
{
  "code": 200,
  "message": "success",
  "data": {
    // 具体数据
  }
}
```

## 5. 注释规范

### 5.1 Vue组件注释
```vue
<!-- 组件用途说明 -->
<template>
  <!-- 重要的DOM结构说明 -->
  <div>
    <!-- 复杂逻辑说明 -->
  </div>
</template>

<script>
export default {
  name: 'ComponentName',
  
  methods: {
    /**
     * 方法说明
     * @param {String} param - 参数说明
     * @return {Object} 返回值说明
     */
    someMethod(param) {
      // 具体实现说明
    }
  }
}
</script>
```

### 5.2 Python注释
```python
class UserService:
    """
    用户服务类
    处理用户相关的业务逻辑
    """
    
    def get_user_info(self, user_id):
        """
        获取用户信息
        Args:
            user_id: 用户ID
        Returns:
            dict: 用户信息字典
        """
        pass
```

## 6. Git规范

### 6.1 分支管理
- master: 主分支，用于生产环境
- develop: 开发分支
- feature/*: 功能分支
- hotfix/*: 紧急修复分支

### 6.2 提交信息
```
feat: 添加新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建过程或辅助工具的变动
```

## 7. 安全规范

### 7.1 前端安全
- XSS防御
- CSRF防御
- 敏感信息加密
- 输入验证

### 7.2 后端安全
- 参数验证
- SQL注入防御
- 权限控制
- 日志记录

## 8. 性能优化

### 8.1 前端优化
- 路由懒加载
- 图片懒加载
- 组件按需加载
- 资源压缩

### 8.2 后端优化
- 数据库索引
- 缓存使用
- 异步任务
- 代码优化

## 9. 测试规范

### 9.1 前端测试
- 单元测试
- 组件测试
- E2E测试

### 9.2 后端测试
- 单元测试
- 接口测试
- 压力测试

## 10. 部署规范

### 10.1 环境配置
- 开发环境
- 测试环境
- 生产环境

### 10.2 部署流程
- 代码审查
- 自动化测试
- 自动化部署
- 监控告警